; $ echo -n "flag{re}" | xxd -p
; 666c61677b72657d
;
; >>> bin(0x666c61677b72657d)
; '0b110011001101100011000010110011101111011011100100110010101111101'
;
; echo -n "flag{re}" | ./task

section .data
    correct_str db "correct :)", 10, 0
    incorrect_str db "incorrect :<", 10, 0

section .text
    global _start

_start:
    xor edi, edi
    xor eax, eax
    mov rsi, rsp
    mov edx, 8
    syscall

    mov rax, [rsp]
    xor ebx, ebx
    xor ecx, ecx

    ; rax = 0b???????????????????????????????????????????????????????????????0
    ;       0b1111101011001010111001001111011011001110110000101101100011001100
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b00??????????????????????????????????????????????????????????????
    ;       0b0011111010110010101110010011110110110011101100001011011000110011
    ror rax, 2
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b?????????????????????????????????????????????????????????????001
    ;       0b1111010110010101110010011110110110011101100001011011000110011001
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b????????????????????????????????????????????????????????????0011
    ;       0b1110101100101011100100111101101100111011000010110110001100110011
    rol rax, 1
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????????????????????????????????????????????????????????0011?1
    ;       0b1010110010101110010011110110110011101100001011011000110011001111
    rol rax, 2
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b???????????????????????????????????????????????????????0011?1??1
    ;       0b0110010101110010011110110110011101100001011011000110011001111101
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????????????????????????????????????????????????????0011?1??10
    ;       0b1100101011100100111101101100111011000010110110001100110011111010
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b10??????????????????????????????????????????????????????0011?1??
    ;       0b1011001010111001001111011011001110110000101101100011001100111110
    ror rax, 2
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b?????????????????????????????????????????????????????0011?1??101
    ;       0b1001010111001001111011011001110110000101101100011001100111110101
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b????????????????????????????????????????????????????0011?1??1011
    ;       0b0010101110010011110110110011101100001011011000110011001111101011
    rol rax, 1
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b11????????????????????????????????????????????????????0011?1??10
    ;       0b1100101011100100111101101100111011000010110110001100110011111010
    ror rax, 2
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b01011????????????????????????????????????????????????????0011?1?
    ;       0b0101100101011100100111101101100111011000010110110001100110011111
    ror rax, 3
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b1011????????????????????????????????????????????????????0011?1?0
    ;       0b1011001010111001001111011011001110110000101101100011001100111110
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b11????????????????????????????????????????????????????0011?1?010
    ;       0b1100101011100100111101101100111011000010110110001100110011111010
    rol rax, 2
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b???????????????????????????????????????????????????0011?1?010110
    ;       0b0101011100100111101101100111011000010110110001100110011111010110
    rol rax, 3
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????????????????????????????????????????????????0011?1?0101100
    ;       0b1010111001001111011011001110110000101101100011001100111110101100
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b????????????????????????????????????????????????0011?1?0101100?0
    ;       0b1011100100111101101100111011000010110110001100110011111010110010
    rol rax, 2
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b?????????????????????????????????????????????0011?1?0101100?0??1
    ;       0b1100100111101101100111011000010110110001100110011111010110010101
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b????????????????????????????????????????????0011?1?0101100?0??11
    ;       0b1001001111011011001110110000101101100011001100111110101100101011
    rol rax, 1
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????????????????????????????????????????0011?1?0101100?0??11?0
    ;       0b0100111101101100111011000010110110001100110011111010110010101110
    rol rax, 2
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b???????????????????????????????????????0011?1?0101100?0??11?0??0
    ;       0b0111101101100111011000010110110001100110011111010110010101110010
    rol rax, 3
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b0???????????????????????????????????????0011?1?0101100?0??11?0??
    ;       0b0011110110110011101100001011011000110011001111101011001010111001
    ror rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????????????????????????????????????0011?1?0101100?0??11?0??00
    ;       0b1111011011001110110000101101100011001001100111110101100101011100100
    rol rax, 2
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b???????????????????????????????????0011?1?0101100?0??11?0??00??1
    ;       0b1011011001110110000101101100011001100111110101100101011100100111
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????????????????????????????????0011?1?0101100?0??11?0??00??11
    ;       0b0110110011101100001011011000110011001111101011001010111001001111
    rol rax, 1
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b????????????????????????????????0011?1?0101100?0??11?0??00??11?1
    ;       0b1011001110110000101101100011001100111110101100101011100100111101
    rol rax, 2
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b?????????????????????????????0011?1?0101100?0??11?0??00??11?1??1
    ;       0b1001110110000101101100011001100111110101100101011100100111101101
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b????????????????????????????0011?1?0101100?0??11?0??00??11?1??11
    ;       0b0011101100001011011000110011001111101011001010111001001111011011
    rol rax, 1
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????????????????????????0011?1?0101100?0??11?0??00??11?1??11?0
    ;       0b1110110000101101100011001100111110101100101011100100111101101100
    rol rax, 2
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b???????????????????????0011?1?0101100?0??11?0??00??11?1??11?0??1
    ;       0b0110000101101100011001100111110101100101011100100111101101100111
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????????????????????0011?1?0101100?0??11?0??00??11?1??11?0??10
    ;       0b1100001011011000110011001111101011001010111001001111011011001110
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b10??????????????????????0011?1?0101100?0??11?0??00??11?1??11?0??
    ;       0b1011000010110110001100110011111010110010101110010011110110110011
    ror rax, 2
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b?????????????????????0011?1?0101100?0??11?0??00??11?1??11?0??101
    ;       0b1000010110110001100110011111010110010101110010011110110110011101
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b????????????????????0011?1?0101100?0??11?0??00??11?1??11?0??1011
    ;       0b0000101101100011001100111110101100101011100100111101101100111011
    rol rax, 1
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????????????????0011?1?0101100?0??11?0??00??11?1??11?0??1011?0
    ;       0b0010110110001100110011111010110010101110010011110110110011101100
    rol rax, 2
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b???????????????0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??1
    ;       0b0110110001100110011111010110010101110010011110110110011101100001
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????????????0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??10
    ;       0b1101100011001100111110101100101011100100111101101100111011000010
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b????????????0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1
    ;       0b0110001100110011111010110010101110010011110110110011101100001011
    rol rax, 2
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b?????????0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??1
    ;       0b0001100110011111010110010101110010011110110110011101100001011011
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b????????0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??10
    ;       0b0011001100111110101100101011100100111101101100111011000010110110
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0
    ;       0b1100110011111010110010101110010011110110110011101100001011011000
    rol rax, 2
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b0?0??????0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??1
    ;       0b0001100110011111010110010101110010011110110110011101100001011011
    ror rax, 3
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b?0??????0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??10
    ;       0b0011001100111110101100101011100100111101101100111011000010110110
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??????0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0
    ;       0b1100110011111010110010101110010011110110110011101100001011011000
    rol rax, 2
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b???0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??0
    ;       0b0110011111010110010101110010011110110110011101100001011011000110
    rol rax, 3
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00
    ;       0b1100111110101100101011100100111101101100111011000010110110001100
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b0011?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?1
    ;       0b0011111010110010101110010011110110110011101100001011011000110011
    rol rax, 2
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b1?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?1001
    ;       0b1111010110010101110010011110110110011101100001011011000110011001
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b?1?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?10011
    ;       0b1110101100101011100100111101101100111011000010110110001100110011
    rol rax, 1
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b?0101100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1
    ;       0b1010110010101110010011110110110011101100001011011000110011001111
    rol rax, 2
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b01100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?01
    ;       0b0110010101110010011110110110011101100001011011000110011001111101
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b1100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?010
    ;       0b1100101011100100111101101100111011000010110110001100110011111010
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b00?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?01011
    ;       0b0010101110010011110110110011101100001011011000110011001111101011
    rol rax, 2
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b01100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?01
    ;       0b0110010101110010011110110110011101100001011011000110011001111101
    ror rax, 3
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b1100?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?010
    ;       0b1100101011100100111101101100111011000010110110001100110011111010
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b00?0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?01011
    ;       0b0010101110010011110110110011101100001011011000110011001111101011
    rol rax, 2
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b0??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?01011001
    ;       0b0101110010011110110110011101100001011011000110011001111101011001
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??11?0??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?010110010
    ;       0b1011100100111101101100111011000010110110001100110011111010110010
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b11?0??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?010110010?0
    ;       0b1110010011110110110011101100001011011000110011001111101011001010
    rol rax, 2
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b0??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?010110010?0111
    ;       0b0010011110110110011101100001011011000110011001111101011001010111
    rol rax, 3
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b??00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?010110010?01110
    ;       0b0100111101101100111011000010110110001100110011111010110010101110
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b00??11?1??11?0??1011?0??10?1??10?0??00?10011?1?010110010?01110?1
    ;       0b0011110110110011101100001011011000110011001111101011001010111001
    rol rax, 2
    setc bl         ; 1
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b0?100??11?1??11?0??1011?0??10?1??10?0??00?10011?1?010110010?0111
    ;       0b0010011110110110011101100001011011000110011001111101011001010111
    ror rax, 3
    setc bl         ; 0
    or rcx, rbx
    shl rcx, 1

    ; rax = 0b?100??11?1??11?0??1011?0??10?1??10?0??00?10011?1?010110010?01110
    ;       0b0100111101101100111011000010110110001100110011111010110010101110
    rol rax, 1
    setc bl         ; 0
    or rcx, rbx

    mov rax, 0x3de061f5d603e994
    cmp rax, rcx
    jnz incorrect

    mov eax, 1
    mov edi, 1
    mov rsi, correct_str
    mov rdx, 11
    syscall

    jmp exit

incorrect:
    mov eax, 1
    mov edi, 1
    mov rsi, incorrect_str
    mov rdx, 13
    syscall

exit:
    mov eax, 60
    xor edi, edi
    syscall